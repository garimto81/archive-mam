{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "ATI Poker Hand Metadata Schema",
  "description": "Metadata schema for poker hand analysis from ATI system",
  "type": "object",
  "required": [
    "hand_id",
    "tournament_id",
    "timestamp",
    "description",
    "hero_name",
    "pot_bb",
    "video_url"
  ],
  "properties": {
    "hand_id": {
      "type": "string",
      "description": "Unique identifier for the hand",
      "pattern": "^[a-z0-9_]+$",
      "minLength": 5,
      "maxLength": 100,
      "examples": [
        "wsop_2024_main_event_hand_3421",
        "mpp_2024_day2_table5_hand_142"
      ]
    },
    "tournament_id": {
      "type": "string",
      "description": "Tournament identifier",
      "pattern": "^[a-z0-9_]+$",
      "examples": ["wsop_2024", "mpp_2024", "apl_2024"]
    },
    "hand_number": {
      "type": "integer",
      "description": "Hand number within the tournament",
      "minimum": 1,
      "examples": [3421, 142]
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "When the hand was played (ISO 8601 format)",
      "examples": ["2024-07-15T14:30:00Z", "2024-11-18T09:15:30+09:00"]
    },
    "duration_seconds": {
      "type": "integer",
      "description": "Hand duration in seconds",
      "minimum": 10,
      "maximum": 600,
      "examples": [45, 120]
    },
    "description": {
      "type": "string",
      "description": "English description of the hand action (used for search)",
      "minLength": 20,
      "maxLength": 2000,
      "examples": [
        "Junglemann makes an insane river call with ace-high against Phil Ivey's triple barrel bluff. After Ivey bets 120bb into a 145bb pot on the river, Junglemann tanks for 3 minutes and makes the hero call.",
        "Daniel Negreanu bluffs all-in on the turn with king-high against Doug Polk who hero-folds top pair."
      ]
    },
    "hero_name": {
      "type": "string",
      "description": "Name of the hero (main player in focus)",
      "minLength": 2,
      "maxLength": 50,
      "examples": ["Junglemann", "Phil Ivey", "Daniel Negreanu", "Doug Polk"]
    },
    "villain_name": {
      "type": "string",
      "description": "Name of the villain (opponent)",
      "minLength": 2,
      "maxLength": 50,
      "examples": ["Phil Ivey", "Doug Polk", "Tom Dwan"]
    },
    "hero_position": {
      "type": "string",
      "description": "Hero's position at the table",
      "enum": ["BTN", "SB", "BB", "UTG", "UTG1", "UTG2", "MP", "MP1", "MP2", "CO"],
      "examples": ["BTN", "BB", "CO"]
    },
    "villain_position": {
      "type": "string",
      "description": "Villain's position at the table",
      "enum": ["BTN", "SB", "BB", "UTG", "UTG1", "UTG2", "MP", "MP1", "MP2", "CO"]
    },
    "hero_stack_bb": {
      "type": "number",
      "description": "Hero's stack size in big blinds",
      "minimum": 0,
      "examples": [150.5, 42.0]
    },
    "villain_stack_bb": {
      "type": "number",
      "description": "Villain's stack size in big blinds",
      "minimum": 0,
      "examples": [187.5, 55.0]
    },
    "street": {
      "type": "string",
      "description": "Street where the key action occurred",
      "enum": ["PREFLOP", "FLOP", "TURN", "RIVER"],
      "examples": ["RIVER", "TURN"]
    },
    "pot_bb": {
      "type": "number",
      "description": "Final pot size in big blinds",
      "minimum": 0,
      "examples": [145.5, 320.0]
    },
    "action_sequence": {
      "type": "array",
      "description": "Sequence of actions in the hand",
      "items": {
        "type": "string"
      },
      "minItems": 1,
      "maxItems": 50,
      "examples": [
        ["fold", "fold", "raise 2.5bb", "call"],
        ["bet 0.5pot", "raise 2x", "all-in", "call"]
      ]
    },
    "hero_action": {
      "type": "string",
      "description": "Hero's key action in the hand",
      "enum": ["fold", "call", "raise", "all-in", "check"],
      "examples": ["call", "all-in", "fold"]
    },
    "result": {
      "type": "string",
      "description": "Hand result from hero's perspective",
      "enum": ["WIN", "LOSE", "SPLIT"],
      "examples": ["WIN", "LOSE"]
    },
    "tags": {
      "type": "array",
      "description": "Searchable tags for categorization",
      "items": {
        "type": "string",
        "enum": [
          "HERO_CALL",
          "BLUFF",
          "VALUE_BET",
          "RIVER_DECISION",
          "TURN_DECISION",
          "FLOP_DECISION",
          "PREFLOP_DECISION",
          "HIGH_STAKES",
          "DEEP_STACK",
          "SHORT_STACK",
          "ALL_IN",
          "SLOW_PLAY",
          "TRAP",
          "CONTINUATION_BET",
          "CHECK_RAISE",
          "DONK_BET",
          "SQUEEZE",
          "3BET",
          "4BET",
          "COOLER",
          "BAD_BEAT",
          "SICK_CALL",
          "SICK_FOLD",
          "TILT"
        ]
      },
      "minItems": 1,
      "maxItems": 10,
      "uniqueItems": true,
      "examples": [
        ["HERO_CALL", "RIVER_DECISION", "HIGH_STAKES"],
        ["BLUFF", "ALL_IN", "TURN_DECISION"]
      ]
    },
    "hand_type": {
      "type": "string",
      "description": "Primary hand classification",
      "enum": ["BLUFF", "VALUE_BET", "HERO_CALL", "HERO_FOLD", "ALL_IN", "SLOW_PLAY"],
      "examples": ["HERO_CALL", "BLUFF"]
    },
    "video_url": {
      "type": "string",
      "format": "uri",
      "description": "GCS URL to the video file",
      "pattern": "^gs://",
      "examples": [
        "gs://poker-videos-prod/wsop_2024/main_event/day5_table3.mp4",
        "gs://poker-videos-prod/mpp_2024/day2_table5.mp4"
      ]
    },
    "video_start_time": {
      "type": "number",
      "description": "Hand start time in video (seconds)",
      "minimum": 0,
      "examples": [3421.5, 1850.0]
    },
    "video_end_time": {
      "type": "number",
      "description": "Hand end time in video (seconds)",
      "minimum": 0,
      "examples": [3482.0, 1920.5]
    },
    "thumbnail_url": {
      "type": "string",
      "format": "uri",
      "description": "Optional thumbnail image URL",
      "examples": [
        "gs://poker-videos-prod/thumbnails/wsop_2024_hand_3421.jpg"
      ]
    },
    "ati_version": {
      "type": "string",
      "description": "ATI system version that generated this metadata",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "examples": ["1.0.0", "2.3.1"]
    },
    "ati_confidence": {
      "type": "number",
      "description": "ATI analysis confidence score (0-1)",
      "minimum": 0,
      "maximum": 1,
      "examples": [0.95, 0.87]
    }
  },
  "additionalProperties": false
}
