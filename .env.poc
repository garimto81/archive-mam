# ==================================================
# 포커 아카이브 RAG 검색 시스템 - PoC 환경 변수 (v1.3.0)
# Architecture: Vertex AI + BigQuery + Qwen3-8B + Perplexica
# ==================================================

# Application
APP_NAME=poker-archive-rag-poc
APP_VERSION=1.3.0
ENVIRONMENT=development  # development | production
DEBUG=true

# API Server (FastAPI)
API_HOST=0.0.0.0
API_PORT=8000
API_WORKERS=1  # PoC는 단일 워커

# =========================
# GCP Configuration
# =========================

# GCP Project
GCP_PROJECT=gg-poker-prod  # 프로덕션 프로젝트 (qwen_hand_analysis 데이터 연동)
GCP_REGION=us-central1
GCP_LOCATION=us-central1

# Google Cloud Storage
GCS_BUCKET_ATI_METADATA=gg-poker-dev-ati-metadata  # ATI JSON 업로드
GCS_BUCKET_PROXY_VIDEOS=gg-poker-dev-proxy-videos  # 720p 프록시 비디오
GCS_BUCKET_CLIPS=gg-poker-dev-clips                # 클립 비디오

# BigQuery
BQ_DATASET=poker_archive_dev
BQ_TABLE_HAND_SUMMARY=hand_summary       # 핸드 요약 테이블
BQ_TABLE_VIDEO_FILES=video_files         # 비디오 파일 메타데이터
BQ_TABLE_VALIDATION=validation_results   # M3 검증 결과 (선택)

# Vertex AI Vector Search
VERTEX_INDEX_ID=poker_hands_index_dev
VERTEX_INDEX_ENDPOINT_ID=poker_hands_endpoint_dev
VERTEX_EMBEDDING_MODEL=text-embedding-004  # TextEmbedding-004
VERTEX_EMBEDDING_DIMENSION=768
VERTEX_AI_INDEX_ENDPOINT=projects/45067711104/locations/us-central1/indexEndpoints/3557757943715725312
VERTEX_AI_DEPLOYED_INDEX_ID=poker_hands_deployed
# Vertex AI Search Type
# hybrid: BM25 + Vector (RRF 결합, 권장)
# vector: Vector만 사용
SEARCH_TYPE=hybrid

# Search Parameters
SEARCH_TOP_K=5  # 검색 결과 최대 개수
SEARCH_SIMILARITY_THRESHOLD=0.7  # 유사도 임계값

# Pub/Sub (ETL Pipeline)
PUBSUB_TOPIC_NEW_METADATA=poker-metadata-new
PUBSUB_SUBSCRIPTION_ETL=poker-etl-worker

# =========================
# LLM Configuration (Qwen3-8B)
# =========================

# LLM Provider: ollama | huggingface
LLM_PROVIDER=ollama  # Week 1: ollama, Week 2: huggingface

# Ollama (Week 1 - 로컬)
LLM_BASE_URL=http://localhost:11434/v1
LLM_API_KEY=ollama  # Ollama는 더미 키
LLM_MODEL=qwen3:8b
LLM_TIMEOUT=30  # 초

# Hugging Face Endpoint (Week 2 - 프로덕션 테스트)
# LLM_BASE_URL=https://xxxxx.us-east-1.aws.endpoints.huggingface.cloud/v1
# LLM_API_KEY=hf_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
# LLM_MODEL=Qwen/Qwen3-8B-Instruct

# LLM Generation Parameters
LLM_TEMPERATURE=0.3  # 낮을수록 일관성 높음
LLM_MAX_TOKENS=600   # 최대 토큰 수
LLM_THINKING_MODE=true  # Qwen3 Thinking Mode 활성화

# RAG Parameters
RAG_CONTEXT_HANDS=5  # RAG 컨텍스트에 포함할 핸드 수
RAG_PROMPT_TEMPLATE=korean  # korean | english

# =========================
# Logging & Monitoring
# =========================

LOG_LEVEL=INFO  # DEBUG | INFO | WARNING | ERROR
LOG_FORMAT=json  # json | text

# Structured Logging
ENABLE_STRUCTURED_LOGGING=true
LOG_FILE_PATH=logs/app.log

# =========================
# CORS (Perplexica UI 연동)
# =========================

CORS_ORIGINS=http://localhost:3000,http://localhost:8080,http://localhost:5173
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOW_HEADERS=*

# =========================
# Feature Flags (PoC)
# =========================

# Mock 모드 (GCP 없이 로컬 테스트)
ENABLE_MOCK_MODE=false  # true: mock_data/ 사용, false: 실제 GCP

# Vision API (M3 Timecode Validation, 선택)
ENABLE_VISION_API=false  # PoC에서는 비활성화 가능

# Cache (선택)
ENABLE_CACHE=false  # PoC에서는 비활성화
REDIS_URL=redis://localhost:6379/0
CACHE_TTL=3600

# =========================
# Development Tools
# =========================

# Auto-reload (개발 중에만 사용)
RELOAD=true

# API Docs
OPENAPI_URL=/api/docs
REDOC_URL=/api/redoc

# =========================
# Cost Monitoring
# =========================

# GCP Cost Alert Threshold (USD)
COST_ALERT_THRESHOLD=130  # PoC 예산
COST_TRACKING_ENABLED=true

# =========================
# Testing
# =========================

# Test 환경에서 사용할 샘플 데이터
TEST_DATA_PATH=mock_data/synthetic_ati
TEST_QUERY_FILE=test_queries.md

# =========================
# Production (Week 2 전환 시)
# =========================

# ENVIRONMENT=production
# DEBUG=false
# GCP_PROJECT=gg-poker-prod
# LLM_PROVIDER=huggingface
# ENABLE_MOCK_MODE=false
# LOG_LEVEL=WARNING
